apiVersion: v1
kind: ConfigMap
metadata:
  name: backstage-app-config
  namespace: backstage
data:
  app-config.production.yaml: |
    app:
      title: CI/CD Integration Server - Backstage
      baseUrl: http://localhost:7007

    organization:
      name: CI/CD Team

    backend:
      baseUrl: http://localhost:7007
      listen:
        port: 7007
      csp:
        connect-src: ["'self'", 'http:', 'https:']
      cors:
        origin: http://localhost:7007
        methods: [GET, HEAD, PATCH, POST, PUT, DELETE]
        credentials: true
      reading:
        allow:
          - host: raw.githubusercontent.com
          - host: github.com
          - host: '*.github.com'
          - host: '*.githubusercontent.com'

    auth:
      environment: development
      providers:
        guest:
          dangerouslyAllowOutsideDevelopment: true

    techdocs:
      builder: local
      generator:
        runIn: local
      publisher:
        type: local

    catalog:
      import:
        entityFilename: catalog-info.yaml
        pullRequestBranchName: backstage-integration
      rules:
        - allow: [Component, System, API, Resource, Location, Group, User, Template, Domain]
      locations:
        - type: url
          target: https://raw.githubusercontent.com/ChunPingWang/integration-server/main/backstage/catalog-info.yaml
          rules:
            - allow: [Component, System, API, Resource, Location, Group, User, Template, Domain]
